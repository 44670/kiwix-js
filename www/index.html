<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Evopedia</title>
    <meta name="description" content="Offline wikipedia reader">
    <meta name="viewport" content="width=device-width">
<!--
Port of Evopedia (offline wikipedia reader) in HTML5/Javascript, with Firefox OS as the primary target
The original application is at http://www.evopedia.info/
It uses wikipedia dumps located at http://dumpathome.evopedia.info/dumps/finished

Author : Mossroy - mossroy@free.fr

License:

    This program is free software; you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by the
    Free Software Foundation; either version 3 of the License, or (at your
    option) any later version.

    This program is distributed in the hope that it will be useful, but
    WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    General Public License for more details.

    You should have received a copy of the GNU General Public
    License along with this program; if not, see
    <http://www.gnu.org/licenses/>.

-->

    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>
    <!-- Use this installation button to install locally without going
         through the marketpace (see app.js) -->
    <!-- <button id="install-btn">Install</button>  -->

    <!-- Write your application here -->

	<h1>Evopedia</h1>
	This is a preliminary work on the port of Evopedia (offline wikipedia reader) in HTML5/Javascript, with Firefox OS as the primary target
	<br />
	The original application is at <a href="http://www.evopedia.info/">http://www.evopedia.info/</a>
	<br />
	<br />
	To use it, you have to first download locally a dump from <a href="http://dumpathome.evopedia.info/dumps/finished">http://dumpathome.evopedia.info/dumps/finished</a> (with a Bittorrent client), and select some of the dowloaded files below.
	<br />
	Current status : I have tested it with the <a href="http://evopedia.info/dumps/wikipedia_small_2010-08-14.torrent">small dump (2010-08-14)</a>, the <a href="http://evopedia.info/dumps/wikipedia_fr_2012-02-03.torrent">French dump (2012-02-03)</a> and the <a href="http://evopedia.info/dumps/wikipedia_frwiktionary_2011-03-16.torrent">French wiktionary dump (2011-03-16)</a>. <b>It does NOT work on the English dump for now</b> (I'm working on it)
	<br />
	<br />
	<ul>
	<li>On desktops, it works at least on recent Firefox and Chrome</li>
	<li>On the Firefos OS simulator, you have (for now) to put the small dump files in a "fake-sdcard" folder of your firefox profile (ex : ~/.mozilla/firefox/xxxx.default/extensions/r2d2b2g@mozilla.org/profile/fake-sdcard). It looks for wikipedia_small_2010-08-14/titles.idx in it. You also need to install the application from the dashboard of the simulator instead of accessing via the browser (due to security restrictions in Firefox OS : only certified webapps can access the sdcard)</li>
	<li>I could not test it on a real Firefox OS device : if someone did, please let me know</li>
	</ul>
	<br />
	It's only a proof of concept sor far : there are certainly many many ways this could be enhanced (suggestions and patche are welcome : the source code is on <a href="https://github.com/mossroy/evopedia-html5">github</a>). In particular, the performance can be optimized when reading an article, and the links inside an article do not work for now.
	<br />
	<div id="openLocalFiles" style="display: none;">
		<br /> Please select the file titles.idx :<br /> <input type="file"
			id="titleFile" /><br /> Please select the files wikipedia_*.dat
		from the same dump :<br /> <input type="file" id="dataFiles" multiple />
	</div>
	<br /> Find titles from the prefix :
	<input type="text" id="prefix" value="" />&nbsp;
	<input type="button" id="searchTitles" value="Search titles" />
	<br /> Choose a title from the filtered list :
	<select id="titleList"></select>
	<br />
	<input type="button" id="toggleDebug" value="Switch debug on/off" />
	<input type="button" id="readData" value="Read article from dump" />
	<div id="debugZone" style="display: none;">
		<table>
			<tr>
				<th>&nbsp;</th>
				<th>Original offsets</th>
				<th>Redirect offsets</th>
			</tr>
			<tr>
				<td>File number</td>
				<td><input type="text" id="filenumber" value="" /></td>
				<td><input type="text" id="redirectfilenumber" value="" /></td>
			</tr>
			<tr>
				<td>Blockstart</td>
				<td><input type="text" id="blockstart" value="" /></td>
				<td><input type="text" id="redirectblockstart" value="" /></td>
			</tr>
			<tr>
				<td>Blockoffset</td>
				<td><input type="text" id="blockoffset" value="" /></td>
				<td><input type="text" id="redirectblockoffset" value="" /></td>
			</tr>
			<tr>
				<td>Length</td>
				<td><input type="text" id="length" value="" /></td>
				<td><input type="text" id="redirectlength" value="" /></td>
			</tr>
		</table>
		<textarea id="debugTextarea" cols="80" rows="10">&nbsp;</textarea>
	</div>
	<div id="articleContent">&nbsp;</div>
	<hr />
    
    <!-- Using require.js, a module system for javascript, include the
         js files. This loads "main.js", which in turn can load other
         files, all handled by require.js:
         http://requirejs.org/docs/api.html#jsfiles -->
    <script type="text/javascript"
            data-main="js/init.js"
            src="js/lib/require.js"></script>
  </body>
</html>
